<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UNC Employee Points</title>
  <style>
    body { font-family: system-index, sans-serif; margin: 24px; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
    .grid { display: grid; gap: 12px; }
    label { display:block; font-size: 14px; margin-bottom: 4px; }
    input, select, textarea { width: 100%; padding: 10px; border:1px solid #e5e7eb; border-radius: 8px; }
    button { padding: 10px 14px; border-radius: 8px; border: 0; cursor: pointer; }
  </style>
</head>
<body>
  <h1>UNC Employee Points (MVP)</h1>

  <div class="card">
    <h3>Register / Update Profile</h3>
    <div class="grid">
      <input id="emp" placeholder="EmployeeID (‡πÄ‡∏ä‡πà‡∏ô U001)" />
      <input id="name" placeholder="Display Name" />
      <input id="nick" placeholder="Nickname" />
      <input id="dept" placeholder="Department" />
      <input id="email" placeholder="Email" />
      <input id="line" placeholder="LINE UserId (‡∏à‡∏≤‡∏Å LIFF ‡∏´‡∏£‡∏∑‡∏≠ Bot)" />
      <button onclick="register()">Save</button>
    </div>
  </div>

  <div class="card">
    <h3>Send Feedback / Kudos</h3>
    <div class="grid">
      <input id="toEmp" placeholder="Target EmployeeID" />
      <input id="actId" placeholder="ActivityID (optional)" />
      <select id="category">
        <option value="Heart">Heart</option>
        <option value="Like">Like</option>
        <option value="Star">Star</option>
      </select>
      <input id="stars" type="number" placeholder="Score (default 1)" />
      <textarea id="msg" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°"></textarea>
      <button onclick="sendFeedback()">Send</button>
    </div>
  </div>

  <div class="card">
    <h3>Event Register</h3>
    <div class="grid">
      <input id="evId" placeholder="EventID" />
      <input id="evEmp" placeholder="EmployeeID" />
      <button onclick="regEvent()">Register</button>
    </div>
  </div>

  <div class="card">
    <h3>Event Check-in (Admin)</h3>
    <div class="grid">
      <input id="regId" placeholder="RegID" />
      <input id="checkedBy" placeholder="CheckedBy (AdminID)" />
      <input id="pointsAttend" placeholder="PointsOnAttend (e.g. 5)" />
      <button onclick="checkin()">Check-in</button>
    </div>
  </div>

  <div id="out"></div>

<script>
const BASE = "https://script.google.com/macros/s/AKfycbx3jVbrAXfw0qdzv0o2cYGcoeiehzu3V5rqrWuHTodDqiJa01xGiIO9yjYYnPtYiZ7K9A/exec"; // <-- replace after deploy

<!-- ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° & ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ï‡πâ‡∏° -->
<div class="card">
  <h3>üéØ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° & ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ï‡πâ‡∏°</h3>
  <p style="font-size:14px;color:#6b7280">
    ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (ActivityID) ‡∏ó‡∏µ‡πà HR ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏ß‡πâ
    ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î ‚Äú‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°‚Äù
  </p>
  <div class="grid">
    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (EmployeeID)
      <input id="empCheckin" placeholder="‡πÄ‡∏ä‡πà‡∏ô U001" />
    </label>

    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (ActivityID)
      <input id="activityCheckin" placeholder="‡πÄ‡∏ä‡πà‡∏ô A2025-001" />
    </label>

    <button onclick="checkinActivity()">
      ‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°
    </button>

    <div id="checkinResult" style="font-size:14px;color:#059669"></div>
  </div>
</div>

<!-- ‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à/‡∏ü‡∏µ‡∏î‡πÅ‡∏ö‡πá‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô (‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πâ‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö) -->
<div class="card">
  <h3>üíö ‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô & ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ï‡πâ‡∏°</h3>
  <p style="font-size:14px;color:#6b7280">
    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πâ‡∏°‡∏Å‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
  </p>
  <div class="grid">
    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á)
      <input id="empFeedback" placeholder="‡πÄ‡∏ä‡πà‡∏ô U001" />
    </label>

    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô (‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö)
      <input id="empTarget" placeholder="‡πÄ‡∏ä‡πà‡∏ô U002" />
    </label>

    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (ActivityID) (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)
      <input id="activityFeedback" placeholder="‡πÄ‡∏ä‡πà‡∏ô A2025-001 (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" />
    </label>

    <label>
      ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à
      <select id="fbCategory">
        <option value="Heart">‚ù§Ô∏è Heart</option>
        <option value="Like">üëç Like</option>
        <option value="Star">‚≠ê Star</option>
      </select>
    </label>

    <label>
      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≤‡∏ß / ‡πÅ‡∏ï‡πâ‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô = 1)
      <input id="fbStars" type="number" min="1" placeholder="1" />
    </label>

    <label>
      ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
      <textarea id="fbMessage" placeholder="‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ..."></textarea>
    </label>

    <button onclick="sendKudos()">
      üíå ‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à & ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ï‡πâ‡∏°
    </button>

    <div id="fbResult" style="font-size:14px;color:#059669"></div>
  </div>
</div>

<!-- ‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á -->
<div class="card">
  <h3>üèÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h3>
  <div class="grid">
    <label>
      ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (EmployeeID)
      <input id="empBalance" placeholder="‡πÄ‡∏ä‡πà‡∏ô U001" />
    </label>
    <button onclick="getMyPoints()">
      üîé ‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°
    </button>
    <div id="balanceResult" style="font-size:14px;color:#111827"></div>
  </div>
</div>

<script>
// ‚ö†Ô∏è ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå
// const BASE = "https://script.google.com/macros/s/....../exec";

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡∏¥‡∏á POST ‡πÑ‡∏õ‡∏´‡∏≤ backend Apps Script
async function apiPost(path, payload) {
  const res = await fetch(BASE + "?path=" + encodeURIComponent(path), {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload || {})
  });
  return res.json();
}

// ‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°
async function checkinActivity() {
  const emp = document.getElementById("empCheckin").value.trim();
  const act = document.getElementById("activityCheckin").value.trim();
  const out = document.getElementById("checkinResult");
  out.textContent = "";

  if (!emp || !act) {
    out.style.color = "#b91c1c";
    out.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
    return;
  }

  try {
    const data = await apiPost("checkin", {
      EmployeeID: emp,
      ActivityID: act
    });
    if (data.ok) {
      out.style.color = "#059669";
      out.textContent = `‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${data.points || 0} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ`;
    } else {
      out.style.color = "#b91c1c";
      out.textContent = "‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (data.error || "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    }
  } catch (e) {
    out.style.color = "#b91c1c";
    out.textContent = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö";
  }
}

// üíö ‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à / ‡∏ü‡∏µ‡∏î‡πÅ‡∏ö‡πá‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
async function sendKudos() {
  const emp = document.getElementById("empFeedback").value.trim();
  const target = document.getElementById("empTarget").value.trim();
  const act = document.getElementById("activityFeedback").value.trim();
  const cat = document.getElementById("fbCategory").value;
  const stars = Number(document.getElementById("fbStars").value || 1);
  const msg = document.getElementById("fbMessage").value.trim();
  const out = document.getElementById("fbResult");
  out.textContent = "";

  if (!emp || !target) {
    out.style.color = "#b91c1c";
    out.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö";
    return;
  }

  if (!msg) {
    out.style.color = "#b91c1c";
    out.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡∏Å‡∏±‡∏ô ‚ù§Ô∏è";
    return;
  }

  try {
    const data = await apiPost("feedback", {
      EmployeeID: emp,
      TargetEmployeeID: target,
      ActivityID: act || "",
      Category: cat,
      Message: msg,
      Stars: stars
    });
    if (data.ok) {
      out.style.color = "#059669";
      out.textContent = "‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢";
      // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
      document.getElementById("fbMessage").value = "";
    } else {
      out.style.color = "#b91c1c";
      out.textContent = "‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (data.error || "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    }
  } catch (e) {
    out.style.color = "#b91c1c";
    out.textContent = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö";
  }
}

// üèÜ ‡∏î‡∏∂‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
async function getMyPoints() {
  const emp = document.getElementById("empBalance").value.trim();
  const out = document.getElementById("balanceResult");
  out.textContent = "";

  if (!emp) {
    out.style.color = "#b91c1c";
    out.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô";
    return;
  }

  try {
    const data = await apiPost("points/balance", { EmployeeID: emp });
    if (data.ok) {
      out.style.color = "#111827";
      out.textContent = `‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${data.balance || 0} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô üéØ`;
    } else {
      out.style.color = "#b91c1c";
      out.textContent = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏î‡πâ: " + (data.error || "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    }
  } catch (e) {
    out.style.color = "#b91c1c";
    out.textContent = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö";
  }
}
</script>
</body>
</html>
